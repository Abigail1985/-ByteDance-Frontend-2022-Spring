"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.mergeConfig = void 0;

var _lodash = _interopRequireDefault(require("lodash.mergewith"));

var _utils = require("@modern-js/utils");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

/**
 * merge configuration from  modern.config.js and plugins.
 *
 * @param configs - Configuration from modern.config.ts or plugin's config hook.
 * @returns - normalized user config.
 */
const mergeConfig = configs => (0, _lodash.default)({}, ...configs, (target, source) => {
  if (Array.isArray(target)) {
    if (Array.isArray(source)) {
      return [...target, ...source];
    } else {
      return typeof source !== 'undefined' ? [...target, source] : target;
    }
  } else if ((0, _utils.isFunction)(source)) {
    return typeof target !== 'undefined' ? [target, source] : [source];
  }

  return undefined;
});

exports.mergeConfig = mergeConfig;