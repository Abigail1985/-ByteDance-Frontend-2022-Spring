/// <reference types="node" />
import { IncomingMessage, ServerResponse } from 'http';
import type { Component } from 'react';
import { PluginFromAsyncManager } from '@modern-js/plugin';
import type { ModernServerContext, BaseSSRServerContext, Metrics, Logger } from '@modern-js/types/server';
import type { NormalizedConfig, UserConfig } from '@modern-js/core';
import type { IAppContext } from '@modern-js/types';
declare type ServerInitInput = {
  loggerOptions: any;
  metricsOptions: any;
};
declare type InitExtension = {
  logger: Logger;
  metrics: Metrics;
};
export declare type Adapter = (req: IncomingMessage, res: ServerResponse) => void | Promise<void>;
export declare type WebServerStartInput = {
  pwd: string;
  config: Record<string, any>;
};
export declare type APIServerStartInput = {
  pwd: string;
  mode: 'function' | 'framework';
  prefix?: string;
  config?: {
    middleware?: Array<any>;
  };
};
export declare type Route = {};
export declare type RequestResult = {
  isfinish: boolean;
};
export declare type SSRServerContext = {};
export declare type RenderContext = {};
export declare const createServerManager: () => import("@modern-js/plugin").AsyncManager<{}, {
  gather: import("@modern-js/plugin").ParallelWorkflow<{
    addWebMiddleware: (_input: any) => void;
    addAPIMiddleware: (_input: any) => void;
  }, unknown>;
  create: import("@modern-js/plugin").AsyncPipeline<ServerInitInput, InitExtension>;
  prepareWebServer: import("@modern-js/plugin").AsyncPipeline<WebServerStartInput, Adapter>;
  prepareApiServer: import("@modern-js/plugin").AsyncPipeline<APIServerStartInput, Adapter>;
  preDevServerInit: import("@modern-js/plugin").ParallelWorkflow<NormalizedConfig, any>;
  setupCompiler: import("@modern-js/plugin").ParallelWorkflow<{}, any[]>;
  postDevServerInit: import("@modern-js/plugin").ParallelWorkflow<NormalizedConfig, any>;
  beforeRouteSet: import("@modern-js/plugin").AsyncPipeline<Route[], Route[]>;
  afterRouteSet: import("@modern-js/plugin").AsyncPipeline<unknown, unknown>;
  preServerInit: import("@modern-js/plugin").ParallelWorkflow<NormalizedConfig, any>;
  postServerInit: import("@modern-js/plugin").ParallelWorkflow<NormalizedConfig, any>;
  listen: import("@modern-js/plugin").ParallelWorkflow<{
    ip: string;
    port: number;
  }, any[]>;
  beforeServerReset: import("@modern-js/plugin").ParallelWorkflow<void, unknown>;
  afterServerReset: import("@modern-js/plugin").ParallelWorkflow<void, unknown>;
  extendSSRContext: import("@modern-js/plugin").AsyncWaterfall<BaseSSRServerContext>;
  extendContext: import("@modern-js/plugin").AsyncPipeline<ModernServerContext, ModernServerContext>;
  handleError: import("@modern-js/plugin").ParallelWorkflow<{
    error: Error;
  }, unknown>;
  beforeMatch: import("@modern-js/plugin").AsyncPipeline<{
    context: ModernServerContext;
  }, any>;
  afterMatch: import("@modern-js/plugin").AsyncPipeline<{
    context: ModernServerContext;
    routeAPI: any;
  }, any>;
  prefetch: import("@modern-js/plugin").ParallelWorkflow<{
    context: SSRServerContext;
  }, unknown>;
  renderToString: import("@modern-js/plugin").AsyncPipeline<{
    App: Component;
    context: RenderContext;
  }, string>;
  beforeRender: import("@modern-js/plugin").AsyncPipeline<{
    context: ModernServerContext;
  }, any>;
  afterRender: import("@modern-js/plugin").AsyncPipeline<{
    context: ModernServerContext;
    templateAPI: any;
  }, any>;
  beforeSend: import("@modern-js/plugin").AsyncPipeline<ModernServerContext, RequestResult>;
  afterSend: import("@modern-js/plugin").ParallelWorkflow<{
    context: ModernServerContext;
  }, unknown>;
  reset: import("@modern-js/plugin").ParallelWorkflow<void, unknown>;
}>;
export declare const serverManager: import("@modern-js/plugin").AsyncManager<{}, {
  gather: import("@modern-js/plugin").ParallelWorkflow<{
    addWebMiddleware: (_input: any) => void;
    addAPIMiddleware: (_input: any) => void;
  }, unknown>;
  create: import("@modern-js/plugin").AsyncPipeline<ServerInitInput, InitExtension>;
  prepareWebServer: import("@modern-js/plugin").AsyncPipeline<WebServerStartInput, Adapter>;
  prepareApiServer: import("@modern-js/plugin").AsyncPipeline<APIServerStartInput, Adapter>;
  preDevServerInit: import("@modern-js/plugin").ParallelWorkflow<NormalizedConfig, any>;
  setupCompiler: import("@modern-js/plugin").ParallelWorkflow<{}, any[]>;
  postDevServerInit: import("@modern-js/plugin").ParallelWorkflow<NormalizedConfig, any>;
  beforeRouteSet: import("@modern-js/plugin").AsyncPipeline<Route[], Route[]>;
  afterRouteSet: import("@modern-js/plugin").AsyncPipeline<unknown, unknown>;
  preServerInit: import("@modern-js/plugin").ParallelWorkflow<NormalizedConfig, any>;
  postServerInit: import("@modern-js/plugin").ParallelWorkflow<NormalizedConfig, any>;
  listen: import("@modern-js/plugin").ParallelWorkflow<{
    ip: string;
    port: number;
  }, any[]>;
  beforeServerReset: import("@modern-js/plugin").ParallelWorkflow<void, unknown>;
  afterServerReset: import("@modern-js/plugin").ParallelWorkflow<void, unknown>;
  extendSSRContext: import("@modern-js/plugin").AsyncWaterfall<BaseSSRServerContext>;
  extendContext: import("@modern-js/plugin").AsyncPipeline<ModernServerContext, ModernServerContext>;
  handleError: import("@modern-js/plugin").ParallelWorkflow<{
    error: Error;
  }, unknown>;
  beforeMatch: import("@modern-js/plugin").AsyncPipeline<{
    context: ModernServerContext;
  }, any>;
  afterMatch: import("@modern-js/plugin").AsyncPipeline<{
    context: ModernServerContext;
    routeAPI: any;
  }, any>;
  prefetch: import("@modern-js/plugin").ParallelWorkflow<{
    context: SSRServerContext;
  }, unknown>;
  renderToString: import("@modern-js/plugin").AsyncPipeline<{
    App: Component;
    context: RenderContext;
  }, string>;
  beforeRender: import("@modern-js/plugin").AsyncPipeline<{
    context: ModernServerContext;
  }, any>;
  afterRender: import("@modern-js/plugin").AsyncPipeline<{
    context: ModernServerContext;
    templateAPI: any;
  }, any>;
  beforeSend: import("@modern-js/plugin").AsyncPipeline<ModernServerContext, RequestResult>;
  afterSend: import("@modern-js/plugin").ParallelWorkflow<{
    context: ModernServerContext;
  }, unknown>;
  reset: import("@modern-js/plugin").ParallelWorkflow<void, unknown>;
}>;
export declare type ServerPlugin = PluginFromAsyncManager<typeof serverManager>;
export declare const createPlugin: (initializer: import("@modern-js/plugin").AsyncInitializer<Partial<import("@modern-js/plugin").Progresses2Threads<{
  gather: import("@modern-js/plugin").ParallelWorkflow<{
    addWebMiddleware: (_input: any) => void;
    addAPIMiddleware: (_input: any) => void;
  }, unknown>;
  create: import("@modern-js/plugin").AsyncPipeline<ServerInitInput, InitExtension>;
  prepareWebServer: import("@modern-js/plugin").AsyncPipeline<WebServerStartInput, Adapter>;
  prepareApiServer: import("@modern-js/plugin").AsyncPipeline<APIServerStartInput, Adapter>;
  preDevServerInit: import("@modern-js/plugin").ParallelWorkflow<NormalizedConfig, any>;
  setupCompiler: import("@modern-js/plugin").ParallelWorkflow<{}, any[]>;
  postDevServerInit: import("@modern-js/plugin").ParallelWorkflow<NormalizedConfig, any>;
  beforeRouteSet: import("@modern-js/plugin").AsyncPipeline<Route[], Route[]>;
  afterRouteSet: import("@modern-js/plugin").AsyncPipeline<unknown, unknown>;
  preServerInit: import("@modern-js/plugin").ParallelWorkflow<NormalizedConfig, any>;
  postServerInit: import("@modern-js/plugin").ParallelWorkflow<NormalizedConfig, any>;
  listen: import("@modern-js/plugin").ParallelWorkflow<{
    ip: string;
    port: number;
  }, any[]>;
  beforeServerReset: import("@modern-js/plugin").ParallelWorkflow<void, unknown>;
  afterServerReset: import("@modern-js/plugin").ParallelWorkflow<void, unknown>;
  extendSSRContext: import("@modern-js/plugin").AsyncWaterfall<BaseSSRServerContext>;
  extendContext: import("@modern-js/plugin").AsyncPipeline<ModernServerContext, ModernServerContext>;
  handleError: import("@modern-js/plugin").ParallelWorkflow<{
    error: Error;
  }, unknown>;
  beforeMatch: import("@modern-js/plugin").AsyncPipeline<{
    context: ModernServerContext;
  }, any>;
  afterMatch: import("@modern-js/plugin").AsyncPipeline<{
    context: ModernServerContext;
    routeAPI: any;
  }, any>;
  prefetch: import("@modern-js/plugin").ParallelWorkflow<{
    context: SSRServerContext;
  }, unknown>;
  renderToString: import("@modern-js/plugin").AsyncPipeline<{
    App: Component;
    context: RenderContext;
  }, string>;
  beforeRender: import("@modern-js/plugin").AsyncPipeline<{
    context: ModernServerContext;
  }, any>;
  afterRender: import("@modern-js/plugin").AsyncPipeline<{
    context: ModernServerContext;
    templateAPI: any;
  }, any>;
  beforeSend: import("@modern-js/plugin").AsyncPipeline<ModernServerContext, RequestResult>;
  afterSend: import("@modern-js/plugin").ParallelWorkflow<{
    context: ModernServerContext;
  }, unknown>;
  reset: import("@modern-js/plugin").ParallelWorkflow<void, unknown>;
} & import("@modern-js/plugin").ClearDraftProgress<{}>>>>, options?: import("@modern-js/plugin").PluginOptions | undefined) => import("@modern-js/plugin").AsyncPlugin<Partial<import("@modern-js/plugin").Progresses2Threads<{
  gather: import("@modern-js/plugin").ParallelWorkflow<{
    addWebMiddleware: (_input: any) => void;
    addAPIMiddleware: (_input: any) => void;
  }, unknown>;
  create: import("@modern-js/plugin").AsyncPipeline<ServerInitInput, InitExtension>;
  prepareWebServer: import("@modern-js/plugin").AsyncPipeline<WebServerStartInput, Adapter>;
  prepareApiServer: import("@modern-js/plugin").AsyncPipeline<APIServerStartInput, Adapter>;
  preDevServerInit: import("@modern-js/plugin").ParallelWorkflow<NormalizedConfig, any>;
  setupCompiler: import("@modern-js/plugin").ParallelWorkflow<{}, any[]>;
  postDevServerInit: import("@modern-js/plugin").ParallelWorkflow<NormalizedConfig, any>;
  beforeRouteSet: import("@modern-js/plugin").AsyncPipeline<Route[], Route[]>;
  afterRouteSet: import("@modern-js/plugin").AsyncPipeline<unknown, unknown>;
  preServerInit: import("@modern-js/plugin").ParallelWorkflow<NormalizedConfig, any>;
  postServerInit: import("@modern-js/plugin").ParallelWorkflow<NormalizedConfig, any>;
  listen: import("@modern-js/plugin").ParallelWorkflow<{
    ip: string;
    port: number;
  }, any[]>;
  beforeServerReset: import("@modern-js/plugin").ParallelWorkflow<void, unknown>;
  afterServerReset: import("@modern-js/plugin").ParallelWorkflow<void, unknown>;
  extendSSRContext: import("@modern-js/plugin").AsyncWaterfall<BaseSSRServerContext>;
  extendContext: import("@modern-js/plugin").AsyncPipeline<ModernServerContext, ModernServerContext>;
  handleError: import("@modern-js/plugin").ParallelWorkflow<{
    error: Error;
  }, unknown>;
  beforeMatch: import("@modern-js/plugin").AsyncPipeline<{
    context: ModernServerContext;
  }, any>;
  afterMatch: import("@modern-js/plugin").AsyncPipeline<{
    context: ModernServerContext;
    routeAPI: any;
  }, any>;
  prefetch: import("@modern-js/plugin").ParallelWorkflow<{
    context: SSRServerContext;
  }, unknown>;
  renderToString: import("@modern-js/plugin").AsyncPipeline<{
    App: Component;
    context: RenderContext;
  }, string>;
  beforeRender: import("@modern-js/plugin").AsyncPipeline<{
    context: ModernServerContext;
  }, any>;
  afterRender: import("@modern-js/plugin").AsyncPipeline<{
    context: ModernServerContext;
    templateAPI: any;
  }, any>;
  beforeSend: import("@modern-js/plugin").AsyncPipeline<ModernServerContext, RequestResult>;
  afterSend: import("@modern-js/plugin").ParallelWorkflow<{
    context: ModernServerContext;
  }, unknown>;
  reset: import("@modern-js/plugin").ParallelWorkflow<void, unknown>;
} & import("@modern-js/plugin").ClearDraftProgress<{}>>>>;
export declare const AppContext: import("@modern-js/plugin").Context<IAppContext>;
export declare const ConfigContext: import("@modern-js/plugin").Context<UserConfig>;
export declare const useConfigContext: () => UserConfig;
export declare const useAppContext: () => IAppContext;
export {};